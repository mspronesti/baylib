\hypertarget{classbn_1_1inference_1_1logic__sampling}{}\doxysection{bn\+::inference\+::logic\+\_\+sampling\texorpdfstring{$<$}{<} Network\+\_\+, Generator\+\_\+ \texorpdfstring{$>$}{>} Class Template Reference}
\label{classbn_1_1inference_1_1logic__sampling}\index{bn::inference::logic\_sampling$<$ Network\_, Generator\_ $>$@{bn::inference::logic\_sampling$<$ Network\_, Generator\_ $>$}}


{\ttfamily \#include $<$logic\+\_\+sampling.\+hpp$>$}

Inheritance diagram for bn\+::inference\+::logic\+\_\+sampling\texorpdfstring{$<$}{<} Network\+\_\+, Generator\+\_\+ \texorpdfstring{$>$}{>}\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=3.000000cm]{classbn_1_1inference_1_1logic__sampling}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classbn_1_1inference_1_1logic__sampling_afb119d6c018aa7e5d5951b09e2794a6b}\label{classbn_1_1inference_1_1logic__sampling_afb119d6c018aa7e5d5951b09e2794a6b}} 
{\bfseries logic\+\_\+sampling} (const network\+\_\+type \&bn, ulong samples, size\+\_\+t memory, uint seed=0, const compute\+::device \&device=compute\+::system\+::default\+\_\+device())
\item 
\mbox{\hyperlink{classbn_1_1marginal__distribution}{marginal\+\_\+distribution}}$<$ probability\+\_\+type $>$ \mbox{\hyperlink{classbn_1_1inference_1_1logic__sampling_a5d18603e91511f92b405c8571c42786c}{make\+\_\+inference}} () override
\end{DoxyCompactItemize}
\doxysubsection*{Private Types}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classbn_1_1inference_1_1logic__sampling_a6c6bb4b1a7c1cc18cbbfbc6aec7e9b4e}\label{classbn_1_1inference_1_1logic__sampling_a6c6bb4b1a7c1cc18cbbfbc6aec7e9b4e}} 
using {\bfseries prob\+\_\+v} = boost\+::compute\+::vector$<$ probability\+\_\+type $>$
\end{DoxyCompactItemize}
\doxysubsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
std\+::vector$<$ ulong $>$ \mbox{\hyperlink{classbn_1_1inference_1_1logic__sampling_a445fdc4d1f7d64529f2881aedfb145c8}{compute\+\_\+result\+\_\+general}} (\mbox{\hyperlink{structbn_1_1bcvec}{bcvec}} \&res, compute\+::vector$<$ int $>$ \&valid)
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}
\subsubsection*{template$<$BNet\+Derived Network\+\_\+, typename Generator\+\_\+ = std\+::mt19937$>$\newline
class bn\+::inference\+::logic\+\_\+sampling$<$ Network\+\_\+, Generator\+\_\+ $>$}
This class represents the Logic Sampling approximate inference algorithm for discrete Bayesian Networks. The implementation uses boost\+::compute to exploit GPGPU optimization. All samples are simulated in parallel, for this reason the maximum memory usage tolerable must be specified to avoid filling up the memory of the device in case of large number of samples. The algorithm main steps are \+:
\begin{DoxyEnumerate}
\item sort nodes in topological order
\item simulate each source node
\item simulate each child node given the parents previous simulation
\item throw out each simulation that doesn\textquotesingle{}t comply with observed evidences
\item estimate the marginal distribution from the valid simulations 
\begin{DoxyTemplParams}{Template Parameters}
{\em Network\+\_\+} & \+: the type of bayesian network (must inherit from \mbox{\hyperlink{classbn_1_1bayesian__network}{bn\+::bayesian\+\_\+network}}) \\
\hline
{\em Generator\+\_\+} & \+: the type of random generator (default Mersenne Twister pseudo-\/random generator) \\
\hline
\end{DoxyTemplParams}

\end{DoxyEnumerate}

\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classbn_1_1inference_1_1logic__sampling_a445fdc4d1f7d64529f2881aedfb145c8}\label{classbn_1_1inference_1_1logic__sampling_a445fdc4d1f7d64529f2881aedfb145c8}} 
\index{bn::inference::logic\_sampling$<$ Network\_, Generator\_ $>$@{bn::inference::logic\_sampling$<$ Network\_, Generator\_ $>$}!compute\_result\_general@{compute\_result\_general}}
\index{compute\_result\_general@{compute\_result\_general}!bn::inference::logic\_sampling$<$ Network\_, Generator\_ $>$@{bn::inference::logic\_sampling$<$ Network\_, Generator\_ $>$}}
\doxysubsubsection{\texorpdfstring{compute\_result\_general()}{compute\_result\_general()}}
{\footnotesize\ttfamily template$<$BNet\+Derived Network\+\_\+, typename Generator\+\_\+  = std\+::mt19937$>$ \\
std\+::vector$<$ ulong $>$ \mbox{\hyperlink{classbn_1_1inference_1_1logic__sampling}{bn\+::inference\+::logic\+\_\+sampling}}$<$ Network\+\_\+, Generator\+\_\+ $>$\+::compute\+\_\+result\+\_\+general (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structbn_1_1bcvec}{bcvec}} \&}]{res,  }\item[{compute\+::vector$<$ int $>$ \&}]{valid }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [private]}}

Accumulate simulation results for general case 
\begin{DoxyParams}{Parameters}
{\em res} & result from simulate node \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
vector for witch the i-\/th element is the number of occurrences of i 
\end{DoxyReturn}
\mbox{\Hypertarget{classbn_1_1inference_1_1logic__sampling_a5d18603e91511f92b405c8571c42786c}\label{classbn_1_1inference_1_1logic__sampling_a5d18603e91511f92b405c8571c42786c}} 
\index{bn::inference::logic\_sampling$<$ Network\_, Generator\_ $>$@{bn::inference::logic\_sampling$<$ Network\_, Generator\_ $>$}!make\_inference@{make\_inference}}
\index{make\_inference@{make\_inference}!bn::inference::logic\_sampling$<$ Network\_, Generator\_ $>$@{bn::inference::logic\_sampling$<$ Network\_, Generator\_ $>$}}
\doxysubsubsection{\texorpdfstring{make\_inference()}{make\_inference()}}
{\footnotesize\ttfamily template$<$BNet\+Derived Network\+\_\+, typename Generator\+\_\+  = std\+::mt19937$>$ \\
\mbox{\hyperlink{classbn_1_1marginal__distribution}{marginal\+\_\+distribution}}$<$ probability\+\_\+type $>$ \mbox{\hyperlink{classbn_1_1inference_1_1logic__sampling}{bn\+::inference\+::logic\+\_\+sampling}}$<$ Network\+\_\+, Generator\+\_\+ $>$\+::make\+\_\+inference (\begin{DoxyParamCaption}{ }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [override]}, {\ttfamily [virtual]}}

Main method of the inference algorithm. Receives the bayesian network but doesn\textquotesingle{}t store it anywhere. It only uses its facilities to perform inference thus avoiding unwanted copies and allowing reusability of the same algorithm object 
\begin{DoxyParams}{Parameters}
{\em bn} & \+: bayesian network \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
\+: the marginal distributions 
\end{DoxyReturn}


Implements \mbox{\hyperlink{classbn_1_1inference_1_1inference__algorithm_a4f17b6c28949271183deef002c28e7a2}{bn\+::inference\+::inference\+\_\+algorithm$<$ Network\+\_\+ $>$}}.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
/home/mspronesti/\+Desktop/baylib/baylib/inference/\mbox{\hyperlink{logic__sampling_8hpp}{logic\+\_\+sampling.\+hpp}}\end{DoxyCompactItemize}
