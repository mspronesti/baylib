\hypertarget{abstract__inference__algorithm_8hpp_source}{}\doxysection{abstract\+\_\+inference\+\_\+algorithm.\+hpp}
\label{abstract__inference__algorithm_8hpp_source}\index{/home/mspronesti/Desktop/baylib/baylib/inference/abstract\_inference\_algorithm.hpp@{/home/mspronesti/Desktop/baylib/baylib/inference/abstract\_inference\_algorithm.hpp}}
\mbox{\hyperlink{abstract__inference__algorithm_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{preprocessor}{\#ifndef BAYLIB\_ABSTRACT\_INFERENCE\_ALGORITHM\_HPP}}
\DoxyCodeLine{2 \textcolor{preprocessor}{\#define BAYLIB\_ABSTRACT\_INFERENCE\_ALGORITHM\_HPP}}
\DoxyCodeLine{3 }
\DoxyCodeLine{4 \textcolor{preprocessor}{\#define CL\_TARGET\_OPENCL\_VERSION 220}}
\DoxyCodeLine{5 \textcolor{preprocessor}{\#define MEMORY\_SLACK 0.9}}
\DoxyCodeLine{6 }
\DoxyCodeLine{7 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{bayesian__utils_8hpp}{baylib/network/bayesian\_utils.hpp}}>}}
\DoxyCodeLine{8 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{marginal__distribution_8hpp}{baylib/probability/marginal\_distribution.hpp}}>}}
\DoxyCodeLine{9 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{random__generator_8hpp}{baylib/tools/random/random\_generator.hpp}}>}}
\DoxyCodeLine{10 \textcolor{preprocessor}{\#include <\mbox{\hyperlink{gpu__utils_8hpp}{baylib/tools/gpu/gpu\_utils.hpp}}>}}
\DoxyCodeLine{11 \textcolor{preprocessor}{\#include <boost/compute/core.hpp>}}
\DoxyCodeLine{12 \textcolor{preprocessor}{\#include <boost/compute.hpp>}}
\DoxyCodeLine{13 \textcolor{preprocessor}{\#include <boost/compute/device.hpp>}}
\DoxyCodeLine{14 \textcolor{preprocessor}{\#include <future>}}
\DoxyCodeLine{15 }
\DoxyCodeLine{18 }
\DoxyCodeLine{19 \textcolor{keyword}{namespace }\mbox{\hyperlink{namespacebn}{bn}} \{}
\DoxyCodeLine{20     \textcolor{keyword}{namespace }inference \{}
\DoxyCodeLine{27         \textcolor{keyword}{template}<\textcolor{keyword}{typename} Probability>}
\DoxyCodeLine{28         \textcolor{keyword}{class }\mbox{\hyperlink{classbn_1_1inference_1_1inference__algorithm}{inference\_algorithm}} \{}
\DoxyCodeLine{29         \textcolor{keyword}{public}:}
\DoxyCodeLine{38             \textcolor{keyword}{explicit} \mbox{\hyperlink{classbn_1_1inference_1_1inference__algorithm_a5b7fadbe1918dfb4de6b9939464693bc}{inference\_algorithm}}(}
\DoxyCodeLine{39                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} nsamples,}
\DoxyCodeLine{40                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} seed = 0}
\DoxyCodeLine{41                             )}
\DoxyCodeLine{42                             : nsamples(nsamples), seed(seed) \{\}}
\DoxyCodeLine{43 }
\DoxyCodeLine{44             \textcolor{keyword}{virtual} \mbox{\hyperlink{classbn_1_1inference_1_1inference__algorithm}{\string~inference\_algorithm}}() = \textcolor{keywordflow}{default};}
\DoxyCodeLine{45 }
\DoxyCodeLine{54             \textcolor{keyword}{virtual} \mbox{\hyperlink{classbn_1_1marginal__distribution}{bn::marginal\_distribution<Probability>}} \mbox{\hyperlink{classbn_1_1inference_1_1inference__algorithm_a717239e2a561fb79fe9c67a5b3effef7}{make\_inference}}(}
\DoxyCodeLine{55                     \textcolor{keyword}{const} \mbox{\hyperlink{classbn_1_1bayesian__network}{bn::bayesian\_network<Probability>}} \&\mbox{\hyperlink{namespacebn}{bn}}}
\DoxyCodeLine{56                     ) = 0;}
\DoxyCodeLine{57 }
\DoxyCodeLine{58             \textcolor{keywordtype}{void} set\_number\_of\_samples(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \_nsamples) \{ nsamples = \_nsamples; \}}
\DoxyCodeLine{59 }
\DoxyCodeLine{60             \textcolor{keywordtype}{void} set\_seed(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \_seed) \{ seed = \_seed; \}}
\DoxyCodeLine{61 }
\DoxyCodeLine{62         \textcolor{keyword}{protected}:}
\DoxyCodeLine{63             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} nsamples;}
\DoxyCodeLine{64             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} seed;}
\DoxyCodeLine{65         \};}
\DoxyCodeLine{66 }
\DoxyCodeLine{74         \textcolor{keyword}{template}<\textcolor{keyword}{typename} Probability>}
\DoxyCodeLine{75         \textcolor{keyword}{class }\mbox{\hyperlink{classbn_1_1inference_1_1parallel__inference__algorithm}{parallel\_inference\_algorithm}} : \textcolor{keyword}{public} \mbox{\hyperlink{classbn_1_1inference_1_1inference__algorithm}{inference\_algorithm}}<Probability> \{}
\DoxyCodeLine{76         \textcolor{keyword}{public}:}
\DoxyCodeLine{77             \textcolor{keyword}{explicit} \mbox{\hyperlink{classbn_1_1inference_1_1parallel__inference__algorithm}{parallel\_inference\_algorithm}}(}
\DoxyCodeLine{78                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} nsamples,}
\DoxyCodeLine{79                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} nthreads = 1,}
\DoxyCodeLine{80                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} seed = 0}
\DoxyCodeLine{81             )}
\DoxyCodeLine{82             : \mbox{\hyperlink{classbn_1_1inference_1_1inference__algorithm}{inference\_algorithm<Probability>}}(nsamples, seed)}
\DoxyCodeLine{83             \{}
\DoxyCodeLine{84                 set\_number\_of\_threads(nthreads);}
\DoxyCodeLine{85             \}}
\DoxyCodeLine{86 }
\DoxyCodeLine{94             \mbox{\hyperlink{classbn_1_1marginal__distribution}{bn::marginal\_distribution<Probability>}} \mbox{\hyperlink{classbn_1_1inference_1_1parallel__inference__algorithm_afbed1ed3f1d785215c1858afb3413ed7}{make\_inference}}(}
\DoxyCodeLine{95                     \textcolor{keyword}{const} \mbox{\hyperlink{classbn_1_1bayesian__network}{bn::bayesian\_network<Probability>}} \&\mbox{\hyperlink{namespacebn}{bn}}}
\DoxyCodeLine{96             )\textcolor{keyword}{ override}}
\DoxyCodeLine{97 \textcolor{keyword}{            }\{}
\DoxyCodeLine{98                 \textcolor{keyword}{typedef} std::future<bn::marginal\_distribution<Probability>> result;}
\DoxyCodeLine{99                 BAYLIB\_ASSERT(std::all\_of(\mbox{\hyperlink{namespacebn}{bn}}.begin(), \mbox{\hyperlink{namespacebn}{bn}}.end(),}
\DoxyCodeLine{100                                           [](\textcolor{keyword}{auto} \&var) \{ return bn::cpt\_filled\_out(var); \}),}
\DoxyCodeLine{101                               \textcolor{stringliteral}{"{}conditional probability tables must be properly filled to"{}}}
\DoxyCodeLine{102                               \textcolor{stringliteral}{"{} run gibbs sampling inference algorithm"{}},}
\DoxyCodeLine{103                               std::runtime\_error)}
\DoxyCodeLine{104 }
\DoxyCodeLine{105                               \mbox{\hyperlink{classbn_1_1marginal__distribution}{bn::marginal\_distribution<Probability>}} inference\_result(\mbox{\hyperlink{namespacebn}{bn}}.begin(), \mbox{\hyperlink{namespacebn}{bn}}.end());}
\DoxyCodeLine{106                 std::vector<result> results;}
\DoxyCodeLine{107                 \mbox{\hyperlink{classbn_1_1seed__factory}{bn::seed\_factory}} sf(nthreads, this-\/>seed);}
\DoxyCodeLine{108 }
\DoxyCodeLine{109                 \textcolor{keyword}{auto} job = [\textcolor{keyword}{this}, \&\mbox{\hyperlink{namespacebn}{bn}}](ulong samples\_per\_thread, uint seed) \{}
\DoxyCodeLine{110                     \textcolor{keywordflow}{return} sample\_step(\mbox{\hyperlink{namespacebn}{bn}}, samples\_per\_thread, seed);}
\DoxyCodeLine{111                 \};}
\DoxyCodeLine{112 }
\DoxyCodeLine{113                 ulong samples\_per\_thread = this-\/>nsamples / nthreads;}
\DoxyCodeLine{114                 \textcolor{comment}{// assigning jobs}}
\DoxyCodeLine{115                 \textcolor{keywordflow}{for} (uint i = 0; i < nthreads -\/ 1; ++i)}
\DoxyCodeLine{116                     results.emplace\_back(std::async(job, samples\_per\_thread, sf.get\_new()));}
\DoxyCodeLine{117 }
\DoxyCodeLine{118                 \textcolor{comment}{// last thread (doing the extra samples if nsamples \% nthreads != 0)}}
\DoxyCodeLine{119                 ulong left\_samples = this-\/>nsamples -\/ (nthreads -\/ 1) * samples\_per\_thread;}
\DoxyCodeLine{120                 results.emplace\_back(std::async(job, samples\_per\_thread, sf.get\_new()));}
\DoxyCodeLine{121 }
\DoxyCodeLine{122                 \textcolor{comment}{// accumulate results of each parallel execution}}
\DoxyCodeLine{123                 \textcolor{keywordflow}{for} (\textcolor{keyword}{auto} \&res: results)}
\DoxyCodeLine{124                     inference\_result += res.get();}
\DoxyCodeLine{125 }
\DoxyCodeLine{126                 \textcolor{comment}{// normalize the distribution before retrieving it}}
\DoxyCodeLine{127                 inference\_result.normalize();}
\DoxyCodeLine{128                 \textcolor{keywordflow}{return} inference\_result;}
\DoxyCodeLine{129             \}}
\DoxyCodeLine{130 }
\DoxyCodeLine{131             \textcolor{keywordtype}{void} set\_number\_of\_threads(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} \_nthreads) \{}
\DoxyCodeLine{132                 nthreads = \_nthreads >= std::thread::hardware\_concurrency() ?}
\DoxyCodeLine{133                         std::thread::hardware\_concurrency() : \_nthreads > 0 ?}
\DoxyCodeLine{134                         \_nthreads : 1;}
\DoxyCodeLine{135             \}}
\DoxyCodeLine{136 }
\DoxyCodeLine{137         \textcolor{keyword}{protected}:}
\DoxyCodeLine{138             \textcolor{keyword}{virtual} \mbox{\hyperlink{classbn_1_1marginal__distribution}{bn::marginal\_distribution<Probability>}} sample\_step(}
\DoxyCodeLine{139                     \textcolor{keyword}{const} \mbox{\hyperlink{classbn_1_1bayesian__network}{bn::bayesian\_network<Probability>}} \&\mbox{\hyperlink{namespacebn}{bn}},}
\DoxyCodeLine{140                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} nsamples\_per\_step,}
\DoxyCodeLine{141                     \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} seed}
\DoxyCodeLine{142             ) = 0;}
\DoxyCodeLine{143 }
\DoxyCodeLine{144             \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} nthreads;}
\DoxyCodeLine{145         \};}
\DoxyCodeLine{146 }
\DoxyCodeLine{147 }
\DoxyCodeLine{148         \textcolor{keyword}{namespace }compute = boost::compute;}
\DoxyCodeLine{149         \textcolor{keyword}{using} boost::compute::lambda::\_1;}
\DoxyCodeLine{150         \textcolor{keyword}{using} boost::compute::lambda::\_2;}
\DoxyCodeLine{158         \textcolor{keyword}{template}<\textcolor{keyword}{typename} Probability>}
\DoxyCodeLine{159         \textcolor{keyword}{class }\mbox{\hyperlink{classbn_1_1inference_1_1vectorized__inference__algorithm}{vectorized\_inference\_algorithm}} : \textcolor{keyword}{public} \mbox{\hyperlink{classbn_1_1inference_1_1inference__algorithm}{inference\_algorithm}}<Probability> \{}
\DoxyCodeLine{160         \textcolor{keyword}{public}:}
\DoxyCodeLine{161             \mbox{\hyperlink{classbn_1_1inference_1_1vectorized__inference__algorithm}{vectorized\_inference\_algorithm}}(}
\DoxyCodeLine{162                     ulong n\_samples, \textcolor{keywordtype}{size\_t} memory,}
\DoxyCodeLine{163                     uint seed = 0,}
\DoxyCodeLine{164                     \textcolor{keyword}{const} compute::device \&device = compute::system::default\_device()}
\DoxyCodeLine{165             )}
\DoxyCodeLine{166             : \mbox{\hyperlink{classbn_1_1inference_1_1inference__algorithm}{inference\_algorithm<Probability>}}(n\_samples, seed)}
\DoxyCodeLine{167             , memory(memory)}
\DoxyCodeLine{168             , device(device)}
\DoxyCodeLine{169             , context(device)}
\DoxyCodeLine{170             , queue(context, device)}
\DoxyCodeLine{171             , rand(queue, seed)}
\DoxyCodeLine{172             \{\}}
\DoxyCodeLine{173 }
\DoxyCodeLine{174             \textcolor{keyword}{using} prob\_v = boost::compute::vector<Probability>;}
\DoxyCodeLine{175 }
\DoxyCodeLine{176         \textcolor{keyword}{protected}:}
\DoxyCodeLine{177             compute::device device;}
\DoxyCodeLine{178             compute::context context;}
\DoxyCodeLine{179             compute::command\_queue queue;}
\DoxyCodeLine{180             compute::default\_random\_engine rand;}
\DoxyCodeLine{181             \textcolor{keywordtype}{size\_t} memory;}
\DoxyCodeLine{182 }
\DoxyCodeLine{189             std::pair<ulong, ulong> \mbox{\hyperlink{classbn_1_1inference_1_1vectorized__inference__algorithm_a668209d974d4e5ec5eb96566bd64d27f}{calculate\_iterations}}(\textcolor{keyword}{const} \mbox{\hyperlink{classbn_1_1bayesian__network}{bayesian\_network<Probability>}} \&\mbox{\hyperlink{namespacebn}{bn}})}
\DoxyCodeLine{190             \{}
\DoxyCodeLine{191                 ulong sample\_p = this-\/>memory / (\mbox{\hyperlink{namespacebn}{bn}}.number\_of\_variables() * \textcolor{keyword}{sizeof}(Probability) + 3 * \textcolor{keyword}{sizeof}(cl\_ushort)) * MEMORY\_SLACK;}
\DoxyCodeLine{192                 \textcolor{keywordflow}{if}(sample\_p < this-\/>nsamples)}
\DoxyCodeLine{193                     \textcolor{keywordflow}{return} \{sample\_p, this-\/>nsamples / sample\_p\};}
\DoxyCodeLine{194                 \textcolor{keywordflow}{else}}
\DoxyCodeLine{195                     \textcolor{keywordflow}{return} \{this-\/>nsamples, 1\};}
\DoxyCodeLine{196             \}}
\DoxyCodeLine{197 }
\DoxyCodeLine{198             \textcolor{keyword}{static} std::vector<Probability> accumulate\_cpt(\mbox{\hyperlink{classbn_1_1cow_1_1cpt}{bn::cow::cpt<Probability>}} cpt) \{}
\DoxyCodeLine{199                 std::vector<Probability> flat\_cpt = cpt.flat();}
\DoxyCodeLine{200                 \textcolor{keywordflow}{for} (bn::state\_t i = 0; i < flat\_cpt.size(); i += cpt.number\_of\_states())}
\DoxyCodeLine{201                     \textcolor{keywordflow}{for} (bn::state\_t j = 1; j < cpt.number\_of\_states() -\/ 1; j++)}
\DoxyCodeLine{202                         flat\_cpt[i + j] += flat\_cpt[i + j -\/ 1];}
\DoxyCodeLine{203                 \textcolor{keywordflow}{return} flat\_cpt;}
\DoxyCodeLine{204             \}}
\DoxyCodeLine{205 }
\DoxyCodeLine{213             \mbox{\hyperlink{structbn_1_1bcvec}{bcvec}} \mbox{\hyperlink{classbn_1_1inference_1_1vectorized__inference__algorithm_a4af003210116dd1b40a1ba28a5c97c39}{simulate\_node}}(}
\DoxyCodeLine{214                     \textcolor{keyword}{const} \mbox{\hyperlink{classbn_1_1cow_1_1cpt}{cow::cpt<Probability>}} \&cpt,}
\DoxyCodeLine{215                     std::vector<bcvec*> \&parents\_result,}
\DoxyCodeLine{216                     \textcolor{keywordtype}{int} dim}
\DoxyCodeLine{217             )}
\DoxyCodeLine{218             \{}
\DoxyCodeLine{219                 std::vector<Probability> flat\_cpt\_accum = accumulate\_cpt(cpt);}
\DoxyCodeLine{220                 \mbox{\hyperlink{structbn_1_1bcvec}{bcvec}} result(dim, cpt.number\_of\_states(), context);}
\DoxyCodeLine{221                 prob\_v device\_cpt(flat\_cpt\_accum.size(), context);}
\DoxyCodeLine{222                 prob\_v threshold\_vec(dim, context);}
\DoxyCodeLine{223                 prob\_v random\_vec(dim, context);}
\DoxyCodeLine{224                 compute::uniform\_real\_distribution<Probability> distribution(0, 1);}
\DoxyCodeLine{225                 compute::vector<int> index\_vec(dim, context);}
\DoxyCodeLine{226 }
\DoxyCodeLine{227                 \textcolor{comment}{// Async copy of the cpt in gpu memory}}
\DoxyCodeLine{228                 compute::copy(flat\_cpt\_accum.begin(), flat\_cpt\_accum.end(), device\_cpt.begin(), queue);}
\DoxyCodeLine{229 }
\DoxyCodeLine{230                 \textcolor{comment}{// cycle for deducing the row of the cpt given the parents state in the previous simulation}}
\DoxyCodeLine{231                 \textcolor{keywordflow}{if}(parents\_result.empty())}
\DoxyCodeLine{232                     compute::fill(index\_vec.begin(), index\_vec.end(), 0, queue);}
\DoxyCodeLine{233                 \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{234                     uint coeff = cpt.number\_of\_states();}
\DoxyCodeLine{235                     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < parents\_result.size(); i++) \{}
\DoxyCodeLine{236                         \textcolor{keywordflow}{if} (i == 0)}
\DoxyCodeLine{237                             compute::transform(parents\_result[i]-\/>state.begin(),}
\DoxyCodeLine{238                                                parents\_result[i]-\/>state.end(),}
\DoxyCodeLine{239                                                index\_vec.begin(),}
\DoxyCodeLine{240                                                \_1 * coeff, queue);}
\DoxyCodeLine{241                         \textcolor{keywordflow}{else}}
\DoxyCodeLine{242                             compute::transform(parents\_result[i]-\/>state.begin(),}
\DoxyCodeLine{243                                                parents\_result[i]-\/>state.end(),}
\DoxyCodeLine{244                                                index\_vec.begin(),}
\DoxyCodeLine{245                                                index\_vec.begin(),}
\DoxyCodeLine{246                                                \_1 * coeff + \_2, queue);}
\DoxyCodeLine{247                         coeff *= parents\_result[i]-\/>cardinality;}
\DoxyCodeLine{248                     \}}
\DoxyCodeLine{249                 \}}
\DoxyCodeLine{250 }
\DoxyCodeLine{251                 \textcolor{comment}{// get the threshold corresponding to the specific row of the cpt for every single simulation}}
\DoxyCodeLine{252                 compute::gather(index\_vec.begin(),}
\DoxyCodeLine{253                                 index\_vec.end(),}
\DoxyCodeLine{254                                 device\_cpt.begin(),}
\DoxyCodeLine{255                                 threshold\_vec.begin(), queue);}
\DoxyCodeLine{256 }
\DoxyCodeLine{257 }
\DoxyCodeLine{258                 \textcolor{comment}{// generate random vector}}
\DoxyCodeLine{259                 distribution.generate(random\_vec.begin(),}
\DoxyCodeLine{260                                       random\_vec.end(),}
\DoxyCodeLine{261                                       rand, queue);}
\DoxyCodeLine{262 }
\DoxyCodeLine{263                 \textcolor{comment}{// confront the random vector with the threshold}}
\DoxyCodeLine{264                 compute::transform(random\_vec.begin(),}
\DoxyCodeLine{265                                    random\_vec.end(),}
\DoxyCodeLine{266                                    threshold\_vec.begin(),}
\DoxyCodeLine{267                                    result.state.begin(),}
\DoxyCodeLine{268                                    \_1 > \_2,}
\DoxyCodeLine{269                                    queue);}
\DoxyCodeLine{270 }
\DoxyCodeLine{271                 \textcolor{comment}{// generalization in case of more than 2 states}}
\DoxyCodeLine{272                 \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i + 2 < cpt.number\_of\_states(); i++) \{}
\DoxyCodeLine{273                     compute::vector<int> temp(dim, context);}
\DoxyCodeLine{274                     compute::transform(index\_vec.begin(),}
\DoxyCodeLine{275                                        index\_vec.end(),}
\DoxyCodeLine{276                                        index\_vec.begin(),}
\DoxyCodeLine{277                                        \_1 + 1, queue);}
\DoxyCodeLine{278                     compute::gather(index\_vec.begin(),}
\DoxyCodeLine{279                                     index\_vec.end(),}
\DoxyCodeLine{280                                     device\_cpt.begin(),}
\DoxyCodeLine{281                                     threshold\_vec.begin(), queue);}
\DoxyCodeLine{282                     compute::transform(random\_vec.begin(),}
\DoxyCodeLine{283                                        random\_vec.end(),}
\DoxyCodeLine{284                                        threshold\_vec.begin(),}
\DoxyCodeLine{285                                        temp.begin(),}
\DoxyCodeLine{286                                        \_1 > \_2, queue);}
\DoxyCodeLine{287                     compute::transform(temp.begin(),}
\DoxyCodeLine{288                                        temp.end(),}
\DoxyCodeLine{289                                        result.state.begin(),}
\DoxyCodeLine{290                                        result.state.begin(),}
\DoxyCodeLine{291                                        \_1 + \_2, queue);}
\DoxyCodeLine{292                 \}}
\DoxyCodeLine{293 }
\DoxyCodeLine{294                 \textcolor{keywordflow}{return} result;}
\DoxyCodeLine{295             \}}
\DoxyCodeLine{296         \};}
\DoxyCodeLine{297     \} \textcolor{comment}{// namespace inference}}
\DoxyCodeLine{298 \} \textcolor{comment}{// namespace bn}}
\DoxyCodeLine{299 }
\DoxyCodeLine{300 \textcolor{preprocessor}{\#endif }\textcolor{comment}{//BAYLIB\_ABSTRACT\_INFERENCE\_ALGORITHM\_HPP}}

\end{DoxyCode}
