\hypertarget{classbaylib_1_1inference_1_1adaptive__importance__sampling}{}\doxysection{baylib\+::inference\+::adaptive\+\_\+importance\+\_\+sampling\texorpdfstring{$<$}{<} Network\+\_\+, Generator\+\_\+ \texorpdfstring{$>$}{>} Class Template Reference}
\label{classbaylib_1_1inference_1_1adaptive__importance__sampling}\index{baylib::inference::adaptive\_importance\_sampling$<$ Network\_, Generator\_ $>$@{baylib::inference::adaptive\_importance\_sampling$<$ Network\_, Generator\_ $>$}}


{\ttfamily \#include $<$adaptive\+\_\+importance\+\_\+sampling.\+hpp$>$}

Inheritance diagram for baylib\+::inference\+::adaptive\+\_\+importance\+\_\+sampling\texorpdfstring{$<$}{<} Network\+\_\+, Generator\+\_\+ \texorpdfstring{$>$}{>}\+:\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=3.000000cm]{classbaylib_1_1inference_1_1adaptive__importance__sampling}
\end{center}
\end{figure}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classbaylib_1_1inference_1_1adaptive__importance__sampling_acabeae2b2e5ed2e0bb8dc0433a9d531a}{adaptive\+\_\+importance\+\_\+sampling}} (const network\+\_\+type \&bn, ulong nsamples, size\+\_\+t memory, double initial\+\_\+learning\+\_\+rate=1, double final\+\_\+learning\+\_\+rate=0.\+05, uint learning\+\_\+step=1000, uint seed=0, const compute\+::device \&device=compute\+::system\+::default\+\_\+device())
\end{DoxyCompactItemize}
\doxysubsection*{Private Types}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classbaylib_1_1inference_1_1adaptive__importance__sampling_a160476a5c21c4f1393f0009b6e978f5c}\label{classbaylib_1_1inference_1_1adaptive__importance__sampling_a160476a5c21c4f1393f0009b6e978f5c}} 
typedef std\+::vector$<$ \mbox{\hyperlink{classbaylib_1_1cow_1_1icpt}{cow\+::icpt}}$<$ probability\+\_\+type $>$ $>$ {\bfseries icpt\+\_\+vector}
\item 
\mbox{\Hypertarget{classbaylib_1_1inference_1_1adaptive__importance__sampling_a65860eef7021534fda50789fc423adcb}\label{classbaylib_1_1inference_1_1adaptive__importance__sampling_a65860eef7021534fda50789fc423adcb}} 
typedef std\+::vector$<$ std\+::vector$<$ uint $>$ $>$ {\bfseries simulation\+\_\+matrix}
\end{DoxyCompactItemize}
\doxysubsection*{Additional Inherited Members}


\doxysubsection{Detailed Description}
\subsubsection*{template$<$BNet\+Derived Network\+\_\+, typename Generator\+\_\+ = std\+::mt19937$>$\newline
class baylib\+::inference\+::adaptive\+\_\+importance\+\_\+sampling$<$ Network\+\_\+, Generator\+\_\+ $>$}
This class represents a possible implementation of the Adaptive Importance Sampling algorithm. The implementation exploits two different types of parallelization, multithreading with the tbb library in the first approximation part and GPGPU with boost\+::compute in the sampling part. The steps of the approximation part are\+:
\begin{DoxyEnumerate}
\item create the sub-\/graph of the nodes that are ancestors of evidence nodes
\item sort the nodes in topological order
\item simulate the sub-\/graph
\item approximate a new cpt for each node given the simulations
\item repeat from 3 until cpts don\textquotesingle{}t change anymore or a maximum number of samples is reached The steps of the sampling part are\+:
\end{DoxyEnumerate}
\begin{DoxyEnumerate}
\item sort all nodes in topological order
\item simulate all root nodes
\item simulate all other nodes given their parents
\item each evidence node simulation is set to the evidence value
\item estimate the marginal probabilities from the simulations 
\begin{DoxyTemplParams}{Template Parameters}
{\em Network\+\_\+} & \+: the type of bayesian network (must inherit from \mbox{\hyperlink{classbaylib_1_1bayesian__net}{baylib\+::bayesian\+\_\+net}}) \\
\hline
{\em Generator\+\_\+} & \+: the type of random generator (default Mersenne Twister pseudo-\/random generator) \\
\hline
\end{DoxyTemplParams}

\end{DoxyEnumerate}

\doxysubsection{Constructor \& Destructor Documentation}
\mbox{\Hypertarget{classbaylib_1_1inference_1_1adaptive__importance__sampling_acabeae2b2e5ed2e0bb8dc0433a9d531a}\label{classbaylib_1_1inference_1_1adaptive__importance__sampling_acabeae2b2e5ed2e0bb8dc0433a9d531a}} 
\index{baylib::inference::adaptive\_importance\_sampling$<$ Network\_, Generator\_ $>$@{baylib::inference::adaptive\_importance\_sampling$<$ Network\_, Generator\_ $>$}!adaptive\_importance\_sampling@{adaptive\_importance\_sampling}}
\index{adaptive\_importance\_sampling@{adaptive\_importance\_sampling}!baylib::inference::adaptive\_importance\_sampling$<$ Network\_, Generator\_ $>$@{baylib::inference::adaptive\_importance\_sampling$<$ Network\_, Generator\_ $>$}}
\doxysubsubsection{\texorpdfstring{adaptive\_importance\_sampling()}{adaptive\_importance\_sampling()}}
{\footnotesize\ttfamily template$<$BNet\+Derived Network\+\_\+, typename Generator\+\_\+  = std\+::mt19937$>$ \\
\mbox{\hyperlink{classbaylib_1_1inference_1_1adaptive__importance__sampling}{baylib\+::inference\+::adaptive\+\_\+importance\+\_\+sampling}}$<$ Network\+\_\+, Generator\+\_\+ $>$\+::\mbox{\hyperlink{classbaylib_1_1inference_1_1adaptive__importance__sampling}{adaptive\+\_\+importance\+\_\+sampling}} (\begin{DoxyParamCaption}\item[{const network\+\_\+type \&}]{bn,  }\item[{ulong}]{nsamples,  }\item[{size\+\_\+t}]{memory,  }\item[{double}]{initial\+\_\+learning\+\_\+rate = {\ttfamily 1},  }\item[{double}]{final\+\_\+learning\+\_\+rate = {\ttfamily 0.05},  }\item[{uint}]{learning\+\_\+step = {\ttfamily 1000},  }\item[{uint}]{seed = {\ttfamily 0},  }\item[{const compute\+::device \&}]{device = {\ttfamily compute\+:\+:system\+:\+:default\+\_\+device()} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [inline]}, {\ttfamily [explicit]}}

Adaptive Sampling algorithm constructor 
\begin{DoxyParams}{Parameters}
{\em nsamples} & \+: number of samples \\
\hline
{\em memory} & \+: maximum amount of memory usable by the opencl device \\
\hline
{\em n\+\_\+threads} & \+: maximum number of threads in the initial learning phasae \\
\hline
{\em initial\+\_\+learning\+\_\+rate} & \+: starting learning rate, must be higher then the final one \\
\hline
{\em final\+\_\+learning\+\_\+rate} & \+: final learning rate, must be lower then the initial one \\
\hline
{\em learning\+\_\+step} & \+: number of iterations after witch the learning phase is stopped \\
\hline
{\em seed} & \+: seed for the random generators \\
\hline
{\em device} & \+: opencl device used for the simulation \\
\hline
\end{DoxyParams}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
/home/mspronesti/\+Desktop/baylib/baylib/inference/\mbox{\hyperlink{adaptive__importance__sampling_8hpp}{adaptive\+\_\+importance\+\_\+sampling.\+hpp}}\end{DoxyCompactItemize}
